(load "~/Documents/isidore.el/isidore.el") ; TODO: make relative path

(ert-deftest ert-test-sum ()
  (should (eql (isi-sum '(0)) 0))
  (should (eql (isi-sum '(1)) 1))
  (should (eql (isi-sum '(1 2)) 3))
  (should (eql (isi-sum '(-1 100)) 99))
  (should (eql (isi-sum '(1 2 3 4 5 6 7 8 9 10)) 55))
  (should (eql (isi-sum '(-12 3 -5 -76)) -90)))

(ert-deftest ert-test-factorial ()
  (should (eql (isi-factorial 0) 1))
  (should (eql (isi-factorial 1) 1))
  (should (eql (isi-factorial 3) 6))
  (should (eql (isi-factorial 4) 24))
  (should (eql (isi-factorial 10) 3628800))
  (should (eql (isi-factorial -1) -1))
  (should (eql (isi-factorial -3) -6))
  (should (eql (isi-factorial -5) -120)))

(ert-deftest ert-test-binomial-coefficient ()
  (should (eql (isi-binomial-coefficient 1 0) 1))
  (should (eql (isi-binomial-coefficient 1 1) 1))
  (should (eql (isi-binomial-coefficient 6 1) 6))
  (should (eql (isi-binomial-coefficient 6 2) 15))
  (should (eql (isi-binomial-coefficient 10 4) 210))
  (should (eql (isi-binomial-coefficient 100 2) 4950)))

(ert-deftest ert-test-mean ()
  (should (eql (isi-mean '(0)) 0))
  (should (eql (isi-mean '(1)) 1))
  (should (eql (isi-mean '(1 1)) 1))
  (should (eql (isi-mean '(1 2 3)) 2))
  (should (eql (isi-mean '(10 47 3 812)) 218))
  (should (eql (isi-mean '(1.1)) 1.1))
  (should (eql (isi-mean '(1.1 12 2 0 57 6.4)) 13.083333333333334))
  (should (eql (isi-mean '(0.1 -5 2 -1)) -0.9750000000000001)))

(ert-deftest ert-test-range ()
  (should (eql (isi-range '(1 0)) 1))
  (should (eql (isi-range '(0 1)) 1))
  (should (eql (isi-range '(-5 -100)) 95))
  (should (eql (isi-range '(2 10 11 21 23 23 22 38 38)) 36))
  (should (eql (isi-range '(2 10 11 21 23 23 22 38 38 -38)) 76)))

(ert-deftest ert-test-fishers-exact-test ()
  (should (eql (isi-fishers-exact-test 3 1 1 3) 0.22857142857142856))
  (should (eql (isi-fishers-exact-test 1 11 9 3) 0.0013460761879122358))
  (should (eql (isi-fishers-exact-test 0 12 10 2) 3.3651904697805894e-05)))
